# Gmail MCP 서버 설정 가이드

## 개요
MCP (Model Context Protocol)를 사용하여 Gmail을 Claude Desktop과 연동하는 완전한 가이드입니다.

## 사전 요구사항
- Claude Desktop 앱 설치
- Node.js와 npm 설치
- Gmail 계정
- Google Cloud Console 접근 권한

## 방법 1: Google API 사용 (권장)

### 1단계: Google Cloud Console 설정

#### 1.1 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com) 접속
2. 상단 프로젝트 선택기에서 "새 프로젝트" 클릭
3. 프로젝트 이름 입력 (예: "Claude Gmail Integration")
4. "만들기" 클릭

#### 1.2 Gmail API 활성화
1. 좌측 메뉴에서 "API 및 서비스" → "라이브러리" 선택
2. "Gmail API" 검색
3. Gmail API 선택 후 "사용" 클릭

#### 1.3 OAuth 동의 화면 구성
1. "API 및 서비스" → "OAuth 동의 화면" 선택
2. 사용자 유형: "외부" 선택 (개인용)
3. 앱 정보 입력:
   - 앱 이름: "Claude Gmail Access"
   - 사용자 지원 이메일: 본인 이메일
   - 개발자 연락처 정보: 본인 이메일
4. "저장 후 계속" 클릭

#### 1.4 범위 추가
1. "범위" 탭에서 "범위 추가 또는 삭제" 클릭
2. 다음 범위들을 추가:
   ```
   https://www.googleapis.com/auth/gmail.readonly
   https://www.googleapis.com/auth/gmail.modify
   https://www.googleapis.com/auth/gmail.labels
   ```
3. "업데이트" 클릭

#### 1.5 OAuth 클라이언트 ID 생성
1. "API 및 서비스" → "사용자 인증 정보" 선택
2. "+사용자 인증 정보 만들기" → "OAuth 클라이언트 ID" 선택
3. 애플리케이션 유형: "데스크톱 애플리케이션" 선택
4. 이름: "Claude Desktop Client"
5. "만들기" 클릭
6. **credentials.json 파일 다운로드** (중요!)

### 2단계: MCP 서버 설정

#### 2.1 설정 파일 위치 확인

**macOS:**
```bash
~/Library/Application Support/Claude/claude_desktop_config.json
```

**Windows:**
```bash
%APPDATA%\Claude\claude_desktop_config.json
```

**Linux:**
```bash
~/.config/Claude/claude_desktop_config.json
```

#### 2.2 Claude Desktop 설정

**읽기 전용 권한 (안전함):**
```json
{
  "mcpServers": {
    "gmail": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-gmail"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/Users/yourname/Downloads/credentials.json"
      }
    }
  }
}
```

**전체 권한 (읽기/쓰기):**
```json
{
  "mcpServers": {
    "gmail-full": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-gmail"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/Users/yourname/Downloads/credentials.json",
        "GMAIL_SCOPES": "https://www.googleapis.com/auth/gmail.modify"
      }
    }
  }
}
```

### 3단계: 첫 실행 및 인증

1. Claude Desktop 재시작
2. Claude에서 Gmail 관련 질문 (예: "최근 이메일 10개 보여줘")
3. 브라우저가 자동으로 열리면서 Google 인증 화면 표시
4. Google 계정으로 로그인
5. 권한 승인
6. "인증이 완료되었습니다" 메시지 확인

## 방법 2: IMAP 사용 (간단함)

### 1단계: Gmail 앱 비밀번호 생성

#### 1.1 2단계 인증 활성화
1. [Google 계정 설정](https://myaccount.google.com) 접속
2. "보안" 탭 선택
3. "Google에 로그인" → "2단계 인증" 활성화

#### 1.2 앱 비밀번호 생성
1. "보안" → "앱 비밀번호" 선택
2. 앱 선택: "메일"
3. 기기 선택: "기타(맞춤 이름)" → "Claude Desktop" 입력
4. **생성된 16자리 비밀번호 복사** (한 번만 표시됨!)

### 2단계: IMAP 설정

```json
{
  "mcpServers": {
    "gmail-imap": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-imap"
      ],
      "env": {
        "IMAP_HOST": "imap.gmail.com",
        "IMAP_PORT": "993",
        "IMAP_USER": "your-email@gmail.com",
        "IMAP_PASSWORD": "앱비밀번호16자리",
        "IMAP_TLS": "true"
      }
    }
  }
}
```

## 고급 설정

### 여러 Gmail 계정 설정
```json
{
  "mcpServers": {
    "gmail-personal": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-gmail"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/path/to/personal-credentials.json"
      }
    },
    "gmail-work": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-gmail"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/path/to/work-credentials.json"
      }
    }
  }
}
```

### 다른 서비스와 함께 사용
```json
{
  "mcpServers": {
    "gmail": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-gmail"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/path/to/credentials.json"
      }
    },
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/yourname/Documents"
      ]
    },
    "calendar": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-google-calendar"
      ],
      "env": {
        "GOOGLE_APPLICATION_CREDENTIALS": "/path/to/credentials.json"
      }
    }
  }
}
```

## 사용 예시

Claude Desktop에서 다음과 같이 사용할 수 있습니다:

### 이메일 읽기
```
최근 받은 이메일 10개를 보여줘
```

```
오늘 받은 이메일 중 중요한 것들을 요약해줘
```

```
"프로젝트"라는 키워드가 포함된 이메일을 찾아줘
```

### 이메일 검색
```
지난 일주일간 받은 이메일 중 첨부파일이 있는 것들을 찾아줘
```

```
발신자가 "example@company.com"인 이메일들을 보여줘
```

### 이메일 관리 (전체 권한 필요)
```
읽지 않은 이메일에 "처리필요" 라벨을 붙여줘
```

```
스팸으로 분류된 이메일들을 삭제해줘
```

## 문제해결

### 일반적인 오류

**오류 1: "credentials.json을 찾을 수 없음"**
```bash
# 파일 경로 확인
ls -la /path/to/credentials.json

# 절대 경로 사용 권장
```

**오류 2: "권한이 거부됨"**
- OAuth 동의 화면에서 모든 권한을 승인했는지 확인
- 범위(scopes) 설정이 올바른지 확인

**오류 3: "API 할당량 초과"**
- Google Cloud Console에서 할당량 확인
- 무료 계정의 경우 일일 한도 존재

**오류 4: "인증 토큰 만료"**
```bash
# 토큰 파일 삭제 후 재인증
rm ~/.config/google-cloud-sdk/credentials.db
```

### 로그 확인

**macOS:**
```bash
tail -f ~/Library/Logs/Claude/claude_desktop.log
```

**Windows:**
```bash
type "%APPDATA%\Claude\Logs\claude_desktop.log"
```

## 보안 고려사항

### 중요한 보안 팁
1. **credentials.json 보안**: 안전한 위치에 저장하고 권한 설정
   ```bash
   chmod 600 /path/to/credentials.json
   ```

2. **최소 권한 원칙**: 필요한 권한만 부여
   - 읽기만 필요한 경우: `gmail.readonly`
   - 라벨 관리까지 필요한 경우: `gmail.modify`

3. **정기적인 권한 검토**: [Google 계정 설정](https://myaccount.google.com/permissions)에서 앱 권한 주기적 검토

4. **민감한 이메일**: 개인정보나 기밀 정보가 Claude에 노출됨을 인지

### 권한별 기능

| 권한 | 기능 |
|------|------|
| `gmail.readonly` | 이메일 읽기, 검색 |
| `gmail.modify` | 읽기 + 라벨 관리, 아카이브 |
| `gmail.compose` | 읽기 + 이메일 작성, 전송 |

## 추가 리소스

- [Google Gmail API 문서](https://developers.google.com/gmail/api)
- [MCP 공식 문서](https://modelcontextprotocol.io)
- [Claude Desktop 설정 가이드](https://docs.anthropic.com/claude/docs)

## 문의 및 지원

문제가 발생하면 다음을 확인하세요:
1. Google Cloud Console에서 API 할당량
2. Claude Desktop 로그 파일
3. credentials.json 파일 권한
4. 네트워크 연결 상태

이제 Claude Desktop에서 Gmail을 완전히 활용할 수 있습니다!
